<svg xmlns="http://www.w3.org/2000/svg" width="2200" height="1400" viewBox="0 0 2200 1400">
  <defs>
    <style>
      .title { font: 700 28px 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif; fill: #0f172a; }
      .group-title { font: 700 18px 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif; fill: #0f172a; }
      .node { fill: #ffffff; stroke: #334155; stroke-width: 1.5; rx: 8; ry: 8; }
      .node-text { font: 13px 'Consolas', 'Menlo', monospace; fill: #111827; }
      .group { fill: #f8fafc; stroke: #94a3b8; stroke-width: 2; rx: 14; ry: 14; }
      .arrow { stroke: #475569; stroke-width: 1.8; fill: none; marker-end: url(#arrowhead); }
      .note { font: 12px 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif; fill: #b91c1c; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="8" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#475569" />
    </marker>
  </defs>

  <rect x="0" y="0" width="2200" height="1400" fill="#f1f5f9"/>
  <text x="40" y="48" class="title">System Data Architecture (Current)</text>

  <!-- PG Governance -->
  <rect x="40" y="80" width="1040" height="300" class="group"/>
  <text x="60" y="112" class="group-title">PostgreSQL: Address Governance (127.0.0.1:5432 / addr_governance)</text>

  <rect x="70" y="140" width="170" height="44" class="node"/><text x="86" y="168" class="node-text">addr_batch</text>
  <rect x="290" y="140" width="170" height="44" class="node"/><text x="306" y="168" class="node-text">addr_raw</text>
  <rect x="510" y="140" width="190" height="44" class="node"/><text x="526" y="168" class="node-text">addr_canonical</text>
  <rect x="510" y="214" width="170" height="44" class="node"/><text x="526" y="242" class="node-text">addr_review</text>

  <rect x="70" y="300" width="190" height="44" class="node"/><text x="86" y="328" class="node-text">addr_task_run</text>
  <rect x="290" y="300" width="190" height="44" class="node"/><text x="306" y="328" class="node-text">api_audit_log</text>
  <rect x="510" y="300" width="220" height="44" class="node"/><text x="526" y="328" class="node-text">agent_execution_log</text>

  <rect x="760" y="140" width="170" height="44" class="node"/><text x="776" y="168" class="node-text">addr_ruleset</text>
  <rect x="760" y="214" width="260" height="44" class="node"/><text x="776" y="242" class="node-text">addr_change_request (missing)</text>
  <rect x="760" y="288" width="240" height="44" class="node"/><text x="776" y="316" class="node-text">addr_audit_event (missing)</text>

  <line x1="240" y1="162" x2="290" y2="162" class="arrow"/>
  <line x1="460" y1="162" x2="510" y2="162" class="arrow"/>
  <line x1="375" y1="184" x2="575" y2="214" class="arrow"/>
  <line x1="845" y1="184" x2="845" y2="214" class="arrow"/>
  <line x1="890" y1="258" x2="890" y2="288" class="arrow"/>

  <!-- PG Trust -->
  <rect x="1120" y="80" width="1040" height="300" class="group"/>
  <text x="1140" y="112" class="group-title">PostgreSQL: Trust Data Hub (127.0.0.1:5442 / trust_meta, currently offline)</text>

  <rect x="1150" y="140" width="220" height="44" class="node"/><text x="1166" y="168" class="node-text">trust_meta.source_registry</text>
  <rect x="1410" y="140" width="220" height="44" class="node"/><text x="1426" y="168" class="node-text">trust_meta.source_schedule</text>
  <rect x="1670" y="140" width="230" height="44" class="node"/><text x="1686" y="168" class="node-text">trust_meta.source_snapshot</text>

  <rect x="1410" y="214" width="240" height="44" class="node"/><text x="1426" y="242" class="node-text">snapshot_quality_report</text>
  <rect x="1670" y="214" width="240" height="44" class="node"/><text x="1686" y="242" class="node-text">snapshot_diff_report</text>
  <rect x="1930" y="214" width="200" height="44" class="node"/><text x="1946" y="242" class="node-text">active_release</text>

  <rect x="1150" y="300" width="230" height="44" class="node"/><text x="1166" y="328" class="node-text">validation_replay_run</text>
  <rect x="1410" y="300" width="220" height="44" class="node"/><text x="1426" y="328" class="node-text">trust_db.admin_division</text>
  <rect x="1670" y="300" width="220" height="44" class="node"/><text x="1686" y="328" class="node-text">trust_db.place_name_index</text>
  <rect x="1930" y="300" width="200" height="44" class="node"/><text x="1946" y="328" class="node-text">trust_db.road/poi</text>

  <line x1="1370" y1="162" x2="1410" y2="162" class="arrow"/>
  <line x1="1630" y1="162" x2="1670" y2="162" class="arrow"/>
  <line x1="1785" y1="184" x2="1525" y2="214" class="arrow"/>
  <line x1="1785" y1="184" x2="1785" y2="214" class="arrow"/>
  <line x1="1900" y1="162" x2="1930" y2="214" class="arrow"/>
  <line x1="1785" y1="184" x2="1265" y2="300" class="arrow"/>

  <!-- SQLite Runtime -->
  <rect x="40" y="420" width="1040" height="430" class="group"/>
  <text x="60" y="452" class="group-title">SQLite: Runtime Control Plane (database/agent_runtime.db)</text>

  <rect x="70" y="480" width="200" height="42" class="node"/><text x="86" y="507" class="node-text">process_definition</text>
  <rect x="310" y="480" width="180" height="42" class="node"/><text x="326" y="507" class="node-text">process_version</text>
  <rect x="530" y="480" width="160" height="42" class="node"/><text x="546" y="507" class="node-text">process_step</text>
  <rect x="730" y="480" width="150" height="42" class="node"/><text x="746" y="507" class="node-text">process_gate</text>

  <rect x="70" y="560" width="130" height="42" class="node"/><text x="86" y="587" class="node-text">task_run</text>
  <rect x="230" y="560" width="130" height="42" class="node"/><text x="246" y="587" class="node-text">task_input</text>
  <rect x="390" y="560" width="150" height="42" class="node"/><text x="406" y="587" class="node-text">task_step_run</text>
  <rect x="570" y="560" width="170" height="42" class="node"/><text x="586" y="587" class="node-text">task_output_json</text>
  <rect x="770" y="560" width="170" height="42" class="node"/><text x="786" y="587" class="node-text">step_run_detail</text>

  <rect x="70" y="640" width="150" height="42" class="node"/><text x="86" y="667" class="node-text">process_draft</text>
  <rect x="250" y="640" width="170" height="42" class="node"/><text x="266" y="667" class="node-text">process_chat_turn</text>
  <rect x="450" y="640" width="200" height="42" class="node"/><text x="466" y="667" class="node-text">draft_version_history</text>
  <rect x="680" y="640" width="170" height="42" class="node"/><text x="696" y="667" class="node-text">draft_comparison</text>

  <rect x="70" y="720" width="180" height="42" class="node"/><text x="86" y="747" class="node-text">confirmation_record</text>
  <rect x="280" y="720" width="150" height="42" class="node"/><text x="296" y="747" class="node-text">operation_audit</text>
  <rect x="460" y="720" width="130" height="42" class="node"/><text x="476" y="747" class="node-text">task_state</text>
  <rect x="620" y="720" width="170" height="42" class="node"/><text x="636" y="747" class="node-text">evidence_records</text>
  <rect x="820" y="720" width="130" height="42" class="node"/><text x="836" y="747" class="node-text">api_call_log</text>

  <line x1="270" y1="501" x2="310" y2="501" class="arrow"/>
  <line x1="490" y1="501" x2="530" y2="501" class="arrow"/>
  <line x1="490" y1="501" x2="730" y2="501" class="arrow"/>
  <line x1="135" y1="602" x2="135" y2="640" class="arrow"/>
  <line x1="200" y1="581" x2="230" y2="581" class="arrow"/>
  <line x1="360" y1="581" x2="390" y2="581" class="arrow"/>
  <line x1="540" y1="581" x2="570" y2="581" class="arrow"/>
  <line x1="540" y1="581" x2="770" y2="581" class="arrow"/>
  <line x1="220" y1="661" x2="250" y2="661" class="arrow"/>
  <line x1="220" y1="661" x2="450" y2="661" class="arrow"/>

  <!-- SQLite Factory -->
  <rect x="1120" y="420" width="1040" height="430" class="group"/>
  <text x="1140" y="452" class="group-title">SQLite: Factory Domain (database/factory*.db)</text>

  <rect x="1150" y="480" width="190" height="42" class="node"/><text x="1166" y="507" class="node-text">factory_products</text>
  <rect x="1380" y="480" width="200" height="42" class="node"/><text x="1396" y="507" class="node-text">factory_processes</text>
  <rect x="1620" y="480" width="180" height="42" class="node"/><text x="1636" y="507" class="node-text">production_lines</text>
  <rect x="1840" y="480" width="120" height="42" class="node"/><text x="1856" y="507" class="node-text">workers</text>

  <rect x="1150" y="560" width="150" height="42" class="node"/><text x="1166" y="587" class="node-text">work_orders</text>
  <rect x="1340" y="560" width="170" height="42" class="node"/><text x="1356" y="587" class="node-text">task_executions</text>
  <rect x="1550" y="560" width="150" height="42" class="node"/><text x="1566" y="587" class="node-text">quality_checks</text>
  <rect x="1740" y="560" width="160" height="42" class="node"/><text x="1756" y="587" class="node-text">factory_metrics</text>

  <rect x="1150" y="640" width="150" height="42" class="node"/><text x="1166" y="667" class="node-text">graph_nodes</text>
  <rect x="1340" y="640" width="190" height="42" class="node"/><text x="1356" y="667" class="node-text">graph_relationships</text>
  <rect x="1570" y="640" width="150" height="42" class="node"/><text x="1586" y="667" class="node-text">failure_queue*</text>
  <rect x="1760" y="640" width="120" height="42" class="node"/><text x="1776" y="667" class="node-text">replay_runs*</text>

  <line x1="1340" y1="501" x2="1150" y2="581" class="arrow"/>
  <line x1="1580" y1="501" x2="1225" y2="581" class="arrow"/>
  <line x1="1710" y1="522" x2="1225" y2="581" class="arrow"/>
  <line x1="1800" y1="501" x2="1840" y2="501" class="arrow"/>
  <line x1="1300" y1="581" x2="1340" y2="581" class="arrow"/>
  <line x1="1510" y1="581" x2="1550" y2="581" class="arrow"/>
  <line x1="1300" y1="661" x2="1340" y2="661" class="arrow"/>
  <line x1="1720" y1="661" x2="1760" y2="661" class="arrow"/>

  <!-- SQLite Entity Graph -->
  <rect x="40" y="890" width="2120" height="450" class="group"/>
  <text x="60" y="922" class="group-title">SQLite: Address Graph Sample (database/entity_graph.db)</text>

  <rect x="70" y="960" width="180" height="42" class="node"/><text x="86" y="987" class="node-text">address_raw_input</text>
  <rect x="290" y="960" width="170" height="42" class="node"/><text x="306" y="987" class="node-text">address_parsed</text>
  <rect x="500" y="960" width="210" height="42" class="node"/><text x="516" y="987" class="node-text">address_standardized</text>
  <rect x="750" y="960" width="220" height="42" class="node"/><text x="766" y="987" class="node-text">address_entity_mapping</text>

  <rect x="70" y="1040" width="230" height="42" class="node"/><text x="86" y="1067" class="node-text">address_admin_division</text>
  <rect x="340" y="1040" width="200" height="42" class="node"/><text x="356" y="1067" class="node-text">address_component</text>
  <rect x="580" y="1040" width="260" height="42" class="node"/><text x="596" y="1067" class="node-text">address_standardization_rule</text>

  <rect x="940" y="1040" width="140" height="42" class="node"/><text x="956" y="1067" class="node-text">entity_node</text>
  <rect x="1120" y="1040" width="190" height="42" class="node"/><text x="1136" y="1067" class="node-text">entity_relationship</text>
  <rect x="1350" y="1040" width="260" height="42" class="node"/><text x="1366" y="1067" class="node-text">entity_multi_source_fusion</text>

  <line x1="250" y1="981" x2="290" y2="981" class="arrow"/>
  <line x1="460" y1="981" x2="500" y2="981" class="arrow"/>
  <line x1="710" y1="981" x2="750" y2="981" class="arrow"/>
  <line x1="1080" y1="1061" x2="1120" y2="1061" class="arrow"/>

  <text x="60" y="1368" class="note">* failure_queue / replay_runs only exist in tc06_line_execution.db</text>
</svg>
